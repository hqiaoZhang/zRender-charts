/**
 * @Author:      zhanghq
 * @DateTime:    2017-12-27 22:10:57
 * @Description: 中国地区
 * @Last Modified By:   zhanghq
 * @Last Modified Time:    2017-12-27 22:10:57
 */
import _ from 'lodash'
import zrender from 'zrender'
import { zrenderInit } from '../../util/util'
import mapJson from './mapdata/china.json'

export default class BaseMap {
  /**
   * 地图默认配置项
   * @return {object} 默认配置项
   */
  defaultSetting () {
    return{
      width: 900,
      height: 800
    }  
  }
 
  /**
   * Creates an instance of Heatmap
   * @param {string} selector 容器元素选择器
   * @param {object} opt 图表组件配置项
   */
  constructor(selector, opt) {
    // 获取配置项
    this.selector = selector
    const defaultSetting = this.defaultSetting()
    this.config = _.merge({}, defaultSetting, opt)
    const { width, height } = this.config
    this.zr = zrenderInit(selector, width, height)
  }

  render() {
    const self = this
    let dataset = []
    let features = mapJson.features
    console.log(features)
    features.map(d => {
      let geometry = d.geometry.coordinates
      geometry.map(geod => {
        let geods = geod 
        geods.map(dd => {
          dataset.push([dd[0] * 5, dd[1] * 5])
        })
      })
    })
    console.log(dataset)
    self.setPolygon(dataset)
  }

  setPolygon(data) {
    const self = this
    const polygonG = new zrender.Group()
    data.map(() => {
      const polygon = new zrender.Polygon({
        shape: {
          points: data
        },
        style: {
          fill: '#3ed5de',
          stroke: '#FFB166'
        }
      })
      polygonG.add(polygon)
    })
    self.zr.add(polygonG)
     
  }
}
